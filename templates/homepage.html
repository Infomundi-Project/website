{% extends "base.html" %} {% block title %}Home{% endblock %}
{% block styles %}
<style type="text/css">
  #chartdiv {
  width: 100%;
  height: 100vh;
  max-width: 100%;
  }
  .fa-solid me-1 {
  color: #ffffff;
  }
  {% if request.cookies.get('theme') != 'light' %}
  .accordion {
  --bs-accordion-btn-bg: #202429;
  --bs-accordion-btn-color: #ffffff;
  --bs-accordion-active-bg: #202429;
  --bs-accordion-active-color: #ffffff;
  --bs-accordion-bg: #131619;
  --bs-accordion-color: #ffffff;
  --bs-accordion-btn-focus-box-shadow: none;
  }
  .accordion-flush .accordion-button {
  border-top: 1px solid #000000;
  }
  .accordion-flush .accordion-item:last-child .accordion-button.collapsed,
  .accordion-flush .accordion-item:last-child .accordion-body {
  border-bottom: 1px solid #000000;
  }
  {% endif %}
  @media (max-width: 968px) {
    #chartdiv {
    width: 100%;
    height: 50vh;
    margin-top: -10.5vh;
    }
  }
</style>
{% endblock %}
{% block content %}
<div class="row">
  <div class="col-lg text-center mb-5 mt-4">
    <img 
      fetchpriority="high" 
      src="{% if request.cookies.get('theme') == 'light' %}{{ url_for('static', filename='img/logos/logo-wide-light-resized.webp') }}{% else %}{{ url_for('static', filename='img/logos/logo-wide-dark-resized.webp') }}{% endif %}"
      class="infomundi-logo"
      id="infomundiLogo"
      height="16"
      width="9" 
      alt="A resilient figure cradling Earth in powerful hands - a testament to strength and global impact. Followed by the website name: Infomundi."
      />

    <ul class="nav nav-underline nav-fill justify-content-center border-top mb-4">
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('views.about') }}">About</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('views.team') }}">Team</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('views.contact') }}">Contact</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('views.policies') }}">Policies</a>
      </li>
    </ul>
    <center>
      <p class="fs-4"><label for="query">Search a Country</label></p>
        <form action="{{ url_for('api.search') }}" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        <div class="input-group justify-content-center">
          <button aria-label="Submit search button" type="submit" class="input-group-text" id="search-icon"><i class="fa-solid fa-magnifying-glass"></i></button>
          <input 
            class="form-control autocomplete" 
            aria-describedby="search-icon"
            style="max-width: 360px;"
            type="search" 
            aria-label="Search Field" 
            id="query" 
            name="query"
            />
        </div>
      </form>
    </center>
    <p class="fs-4 mt-2 mb-2">or</p>
    <div class="d-inline-flex">
      <p class="fs-3">Use the Globe to Choose</p>
    </div>
    {% if not is_mobile %}
    <div class="accordion" id="accordionExample">
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
            aria-expanded="true" aria-controls="collapseOne">
          <i class="fa-solid me-1 fa-chart-simple"></i><span class="ms-2">Statistics</span>
          </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse {{ 'show' if not is_mobile else ''}}" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <div class="d-flex flex-row flex-wrap text-start justify-content-between">
              <div class="p-2">
                <p class="fs-4"><i class="fa-solid me-1 fa-database"></i>Database</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-globe"></i>Countries: {{ statistics['total_countries_supported'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-newspaper"></i>News: {{ statistics['total_news'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-rss"></i>Sources: {{ statistics['total_feeds'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-arrows-rotate"></i>Updated: {{ statistics['last_updated_message'] }}</p>
              </div>
              <div class="p-2">
                <p class="fs-4"><i class="fa-solid me-1 fa-users-rectangle"></i>Community</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-comments"></i>Comments: {{ statistics['total_comments'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-eye"></i>Clicks: {{ statistics['total_clicks'] }} (last 7 days)</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-code-merge"></i>Version: 1.2.1<!-- <span class="badge text-bg-success">New!</span> --></p>
                <p class="fs-6"><a href="https://github.com/Infomundi-Project" target="_blank" class="text-decoration-none"><i class="fa-solid me-1 fa-arrow-up-right-from-square"></i>Latest changelog</a></p>
              </div>
              <div class="p-2">
                <p class="fs-4"><i class="fa-solid me-1 fa-user"></i>Session</p>
                
                {% if user.is_authenticated %}
                <p class="fs-6"><i class="fa-solid me-1 fa-circle-user"></i>Welcome, {{ user.username }}!</p>
                <p class="fs-6"><a href="{{ url_for('auth.logout') }}" class="text-decoration-none"><i class="fa-solid fa-right-from-bracket me-1"></i>Logout</a></p>
                {% else %}
                <p class="fs-6"><a href="{{ url_for('auth.register') }}" class="text-decoration-none"><i class="fa-solid me-1 fa-user-pen"></i>Register</a></p>
                <p class="fs-6"><a href="{{ url_for('auth.login') }}" class="text-decoration-none"><i class="fa-solid me-1 fa-right-to-bracket"></i>Log in</a></p>
                {% endif %}
                
                {% if session.get('last_visited_country', '') %}
                <p class="fs-6"><a href="https://infomundi.net/{{ session['last_visited_country'] }}" class="text-decoration-none"><i class="fa-solid me-1 fa-arrow-up-right-from-square"></i>Last visited country</a></p>
                {% endif %}
                {% if session.get('last_visited_news', '') %}
                <p class="fs-6"><a href="https://infomundi.net/{{ session['last_visited_news'] }}" class="text-decoration-none"><i class="fa-solid me-1 fa-arrow-up-right-from-square"></i>Last visited news</a></p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
  <div class="col-lg p-1">
    <div id="chartdiv"></div>
    {% if is_mobile %}
      <div class="accordion mt-3" id="accordionExample">
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
            aria-expanded="true" aria-controls="collapseOne">
          <i class="fa-solid me-1 fa-chart-simple"></i><span class="ms-2">Statistics</span>
          </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse {{ 'show' if not is_mobile else ''}}" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <div class="d-flex flex-row flex-wrap text-start justify-content-between">
              <div class="p-2">
                <p class="fs-4"><i class="fa-solid me-1 fa-database"></i>Database</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-globe"></i>Countries: {{ statistics['total_countries_supported'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-newspaper"></i>News: {{ statistics['total_news'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-rss"></i>Sources: {{ statistics['total_feeds'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-arrows-rotate"></i>Updated: {{ statistics['last_updated_message'] }}</p>
              </div>
              <div class="p-2">
                <p class="fs-4"><i class="fa-solid me-1 fa-users-rectangle"></i>Community</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-comments"></i>Comments: {{ statistics['total_comments'] }}</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-eye"></i>Clicks: {{ statistics['total_clicks'] }} (last 7 days)</p>
                <p class="fs-6"><i class="fa-solid me-1 fa-code-merge"></i>Version: 1.2.1<!-- <span class="badge text-bg-success">New!</span> --></p>
                <p class="fs-6"><a href="https://github.com/Infomundi-Project" target="_blank" class="text-decoration-none"><i class="fa-solid me-1 fa-arrow-up-right-from-square"></i>Latest changelog</a></p>
              </div>
              <div class="p-2">
                <p class="fs-4"><i class="fa-solid me-1 fa-user"></i>Session</p>
                
                {% if user.is_authenticated %}
                <p class="fs-6"><i class="fa-solid me-1 fa-circle-user"></i>Welcome, {{ user.username }}!</p>
                <p class="fs-6"><a href="{{ url_for('auth.logout') }}" class="text-decoration-none"><i class="fa-solid fa-right-from-bracket me-1"></i>Logout</a></p>
                {% else %}
                <p class="fs-6"><a href="{{ url_for('auth.register') }}" class="text-decoration-none"><i class="fa-solid me-1 fa-user-pen"></i>Register</a></p>
                <p class="fs-6"><a href="{{ url_for('auth.login') }}" class="text-decoration-none"><i class="fa-solid me-1 fa-right-to-bracket"></i>Log in</a></p>
                {% endif %}
                
                {% if session.get('last_visited_country', '') %}
                <p class="fs-6"><a href="https://infomundi.net/{{ session['last_visited_country'] }}" class="text-decoration-none"><i class="fa-solid me-1 fa-arrow-up-right-from-square"></i>Last visited country</a></p>
                {% endif %}
                {% if session.get('last_visited_news', '') %}
                <p class="fs-6"><a href="https://infomundi.net/{{ session['last_visited_news'] }}" class="text-decoration-none"><i class="fa-solid me-1 fa-arrow-up-right-from-square"></i>Last visited news</a></p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
      {% endif %}
  </div>
</div>
{% endblock %}
{% block scripts %}
<script defer
  src="{{ url_for('static', filename='js/amcharts/index.js') }}"
  ></script>
<script defer
  src="{{ url_for('static', filename='js/amcharts/map.js') }}"
  ></script>
<script defer
  src="{{ url_for('static', filename='js/amcharts/worldLow.js') }}"
  ></script>
<script defer
  src="{{ url_for('static', filename='js/amcharts/animated.js') }}"
  ></script>
<script defer
  src="{{ url_for('static', filename='js/chart.js') }}"
  ></script>
<script 
  src="{{ url_for('static', filename='js/libs/jquery-ui-1.13.1.min.js') }}" 
  ></script>
<script 
  src="{{ url_for('static', filename='js/autocomplete.js') }}"
  ></script>
{% endblock %}
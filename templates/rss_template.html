{% extends "base.html" %} {% block title %}{{ country_name }} {{ news_filter }}{% endblock %}
{% block styles %}
<style type="text/css">
  .centered {
  padding: 20px;
  border-radius: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 30vh;
  margin: 0;
  }
  .text-body-secondary {
  padding-right: 10%
  }
  .card {
  min-height: 170px;
  max-height: 200px;
  }
  .text-body-secondary {
  padding-right: 30%;
  }
  @media (max-width: 1600px) {
  .text-body-secondary {
  padding-right: 0%
  }
  }
  /* Improved mobile compatibility */
  @media (max-width: 968px) {
  .centered {
  text-align: center;
  }
  .pagination {
  margin-top: 20px;
  }
  .col-3 {
  flex: 0 0 100%;
  max-width: 100%;
  }
  .card {
  max-width: 100%;
  max-height: 100%;
  }
  .text-body-secondary {
  padding-right: 0%;
  }
  .card-img {
  max-width: 500px;
  max-height: 300px;
  }
  }
</style>
{% endblock %}
{% block content %}
<h1 class="centered" style="color: white;">
  <img src="https://hatscripts.github.io/circle-flags/flags/{{ country_code }}.svg" style="max-width: 48px; padding-right: 5px" alt="Flag of {{ country_name }}"> {{ country_name }} {{ news_filter }} News - Page {{ page_num }}
</h1>
<div id="google_translate_element"></div>
<ul class="nav nav-pills justify-content-center mb-2">
  <li class="nav-item">
    <a class="nav-link text-light {{ 'active' if 'general' in selected_filter else '' }}" href="/news?country={{ country_code }}">General</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'disabled text-secondary' if 'economy' not in supported_categories else '' }} {{ 'active' if 'economy' in selected_filter else '' }}" href="/news?country={{ country_code }}&section=economy">Economy</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'disabled text-secondary' if 'politics' not in supported_categories else '' }} {{ 'active' if 'politics' in selected_filter else '' }}" href="/news?country={{ country_code }}&section=politics">Politics</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'disabled text-secondary' if 'technology' not in supported_categories else '' }} {{ 'active' if 'technology' in selected_filter else '' }}" href="/news?country={{ country_code }}&section=technology">Technology</a>
  </li>
  <li class="nav-item">
    <a class="nav-link {{ 'disabled text-secondary' if 'sports' not in supported_categories else '' }} {{ 'active' if 'sports' in selected_filter else '' }}" href="/news?country={{ country_code }}&section=sports">Sports</a>
  </li>
</ul>
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    {% for page in range(1, total_pages+1) %} 
    <li class="page-item">
      <a class="page-link" href="#" data-page="{{ page }}" style="color: black;">{{ page }}</a>
    </li>
    {% endfor %} 
  </ul>
</nav>
<div class="row">
  {% for item in feeds %} 
  <div class="p-1 col-6 col-md-3">
    <div class="card mb-1">
      <div class="row g-0">
        <div class="col-md-4">
          <a href="{{ item['link'] }}" target="_blank">
          <img src="{{ item['media_content']['url'] }}" class="rounded-start img-fluid card-img" style="min-height: 190px; max-height: 195px" alt="News image">
          </a>
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <a href="{{ item['link'] }}" style="text-decoration:none;" target="_blank">
              <h6 class="card-title" style="color: black; overflow: hidden; min-height: 55px; max-height: 58px">{{ item['title'] }}</h6>
            </a>
            <small>
              <p style="min-height: 45px; max-height: 46px; overflow: hidden;" class="card-text text-primary">{{ item['publisher'] }}</p>
            </small>
          </div>
          <div class="card-footer">
            <a href="{{ item['publisher_link'] }}" target="_blank">
            <img src="{{ item['feed_icon'] }}" class="object-fit-scale border rounded" style="min-height: 30px; min-width: 30px; max-height: 31px; max-width: 31px">
            </a>
            <small class="text-body-secondary">{{ item['pubDate'] }}</small>
            <a class="btn btn-sm btn-dark" href="/comments?id={{ item['id'] }}&category={{ selected_filter }}" role="button">{{ item['total_comments'] }}
            <i class="fa fa-comment"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %} 
</div>
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    {% for page in range(1, total_pages+1) %} 
    <li class="page-item">
      <a class="page-link" href="#" data-page="{{ page }}" style="color: black;">{{ page }}</a>
    </li>
    {% endfor %} 
  </ul>
</nav>
{% endblock %}
{% block scripts %}
<script 
  type="text/javascript" 
  src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
  ></script>
<script type="text/javascript">
  function googleTranslateElementInit() {
      new google.translate.TranslateElement({
              pageLanguage: '{{ country_code }}'
          },
          'google_translate_element'
      );
  }
</script>
<script>
  $(document).ready(function() {
      $('.filter').on('click', function() {
          var activeUrl = window.location.href;
          var filter = $(this).data('filter');
          if (activeUrl.indexOf('country=') !== -1) {
              var newUrl = activeUrl.replace(/&section=[^&]*/, '') + '&section=' + filter;
          } else {
              var newUrl = activeUrl + '&country=BR&section=' + filter;
          }
          window.location.href = newUrl;
      });
      $('.page-link').on('click', function() {
          var activeUrl = window.location.href;
          var page = $(this).data('page');
          if (activeUrl.indexOf('&page=') !== -1) {
              var newUrl = activeUrl.replace(/&page=[^&]*/, '') + '&page=' + page;
          } else {
              var newUrl = activeUrl + '&page=' + page;
          }
          window.location.href = newUrl;
      });
      $('#alertModal').modal('show');
  });
</script>
{% endblock %}